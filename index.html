<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>â„ï¸ Winterwarn-App Schweiz</title>
<style>
body{font-family:system-ui;background:#0f172a;color:#e5e7eb;margin:0;padding:16px}
h1{font-size:1.4rem}
.card{background:#020617;border-radius:14px;padding:14px;margin-top:14px}
select,input,button{width:100%;padding:10px;border-radius:10px;border:none;margin-top:6px;font-size:1rem}
button{background:#2563eb;color:white;font-weight:600}
button.test{background:#f59e0b;color:black}
.status{margin-top:8px;font-size:.95rem}
.ampel{font-size:1.3rem;margin-top:8px}
.green{color:#22c55e}.yellow{color:#eab308}.orange{color:#fb923c}.red{color:#ef4444}
</style>
</head>
<body>

<h1>â„ï¸ Winterwarn-App Schweiz</h1>

<div class="card">
<h3>ğŸ“ Ort auswÃ¤hlen</h3>
<select id="location">
<option value="St. Urban">St. Urban</option>
<option value="Ettiswil">Ettiswil</option>
<option value="Sursee">Sursee</option>
<option value="Luzern">Luzern</option>
<option value="Willisau">Willisau</option>
</select>
<div id="ampel" class="ampel">Status: â€“</div>
</div>

<div class="card">
<h3>ğŸ“§ E-Mail-EmpfÃ¤nger (max. 15)</h3>
<input id="emails" placeholder="email1@gmail.com, email2@gmail.com">
</div>

<div class="card">
<h3>âš ï¸ Alarm auslÃ¶sen (Simulation)</h3>
<button class="test" onclick="sendTest('green')">ğŸŸ¢ Test GRÃœN</button>
<button class="test" onclick="sendTest('yellow')">ğŸŸ¡ Test GELB</button>
<button class="test" onclick="sendTest('orange')">ğŸŸ  Test ORANGE</button>
<button class="test" onclick="sendTest('red')">ğŸ”´ Test ROT</button>
<div id="status" class="status"></div>
</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxETt5pEIsHFU19u2IL1ouZ_crteiaepipClCflXxjDhDUEvYH_-BaJFBAJQCntdZy_/exec";

function sendTest(level){
  const emails = document.getElementById('emails').value
    .split(',').map(e=>e.trim()).filter(e=>e);

  if(emails.length===0){alert('Bitte mindestens eine E-Mail eingeben');return;}

  const location=document.getElementById('location').value;

  updateAmpel(level);

  fetch(SCRIPT_URL,{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({
      level:level,
      location:location,
      type: level==='green'?'Keine akute Gefahr':'Starker Schneefall & Eisgefahr',
      start: level==='green'?'-':'Morgen 06:30',
      peak: level==='green'?'-':'09:00',
      end: level==='green'?'-':'13:00',
      snow: level==='green'?0:12,
      temp: level==='green'?3:-2,
      ov: level==='green'?'normal':'hoch',
      school: level==='green'?'unproblematisch':'gefÃ¤hrlich',
      emails:emails
    })
  })
  .then(r=>r.text())
  .then(t=>document.getElementById('status').textContent='Server: '+t)
  .catch(e=>document.getElementById('status').textContent='Fehler: '+e);
}

function updateAmpel(level){
  const el=document.getElementById('ampel');
  el.className='ampel '+level;
  if(level==='green')el.textContent='ğŸŸ¢ GRÃœN â€“ keine Gefahr';
  if(level==='yellow')el.textContent='ğŸŸ¡ GELB â€“ erhÃ¶hte Gefahr';
  if(level==='orange')el.textContent='ğŸŸ  ORANGE â€“ starke Gefahr';
  if(level==='red')el.textContent='ğŸ”´ ROT â€“ EXTREME Gefahr';
}
</script>

</body>
</html>
